import React from 'react';
import Icon from './Icon';
import styles from './styles.css';
import { withReaction } from 'plugin-api/beta/client/hocs';
import { t } from 'plugin-api/beta/client/services';
import cn from 'classnames';

const plugin = 'talk-plugin-respect';

class RespectButton extends React.Component {
  handleClick = () => {
    const {
      postReaction,
      deleteReaction,
      showSignInDialog,
      alreadyReacted,
      user,
    } = this.props;

    // If the current user does not exist, trigger sign in dialog.
    if (!user) {
      showSignInDialog();
      return;
    }

    if (alreadyReacted) {
      deleteReaction();
    } else {
      postReaction();
    }
  };

  render() {
    const { count, alreadyReacted } = this.props;
    return (
      <div className={cn(styles.container, `${plugin}-container`)}>
        <button
          className={cn(
            styles.button,
            {
              [`${
                styles.respected
              } talk-plugin-respect-respected`]: alreadyReacted,
            },
            `${plugin}-button`
          )}
          onClick={this.handleClick}
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
          >
            <g fill="#FFF" fillRule="evenodd" stroke="currentColor">
              <path d="M19.414 9.462c.024-.006.034-.016.035-.016l.07-.45.158-.992.003-.015a195.475 195.475 0 0 1 .217-1.323l.019-.104c-.002-.008-.003-.013.005-.034.078-.741.74-1.264 1.531-1.232.37.022.745.184 1.01.451.23.24.332.556.337.857.028.193-.164 5.515-.271 6.837-.125 1.975-1.384 3.78-3.351 4.851l-.002.001c-3.182 1.711-7.174.817-9.093-2.073l-4.01-6.526c-.2-.29-.237-.622-.168-.997.07-.377.34-.69.703-.897.676-.387 1.586-.168 1.99.478l2.661 4.359c.01.015.03.02.042.012.016-.01.02-.03.01-.047L8.6 8.222l-.018-.034c-.013-.026-.013-.026.004.003l-.21-.345-.46-.758-.005-.007a54.421 54.421 0 0 1-.683-1.135c-.122-.246-.117-.42-.056-.752.069-.376.34-.689.683-.884.352-.224.762-.254 1.222-.14.273.092.553.499 1.883 2.535l.087.132a248.428 248.428 0 0 1 1.48 2.298c.009.015.029.02.041.012.015-.01.02-.03.009-.048l-3.438-5.58c-.2-.29-.237-.623-.168-.997.07-.377.341-.69.73-.911.259-.129.505-.178.902-.184.44.056.844.274 1.08.648l3.994 6.52c.01.015.03.02.042.011.015-.01.02-.03.007-.05l-2.804-4.605c-.197-.344-.251-.73-.152-1.01.065-.354.286-.624.624-.856a1.47 1.47 0 0 1 .781-.195c.531.001 1.016.254 1.224.674l4.003 6.858c.021.03.032.035.012.04z" />
              <path d="M13.341 11.587c.014-.02.015-.035.016-.035l-.235-.39-.517-.862-.007-.012a195.478 195.478 0 0 1-.685-1.154c-.03-.051-.03-.051-.052-.092-.007-.004-.01-.007-.018-.029-.417-.618-.245-1.444.381-1.927a1.58 1.58 0 0 1 1.064-.305c.33.038.611.213.81.44.144.13 3.418 4.33 4.186 5.413 1.174 1.592 1.37 3.785.551 5.87v.002c-1.339 3.356-4.97 5.237-8.3 4.256l-7.266-2.42c-.339-.094-.581-.326-.77-.657-.188-.333-.181-.747-.037-1.14.269-.73 1.107-1.148 1.83-.912l4.842 1.628c.017.006.036-.004.04-.017.006-.018-.004-.036-.023-.042l-4.892-1.614-.035-.015c-.026-.011-.026-.011.005 0l-.382-.129-.841-.285-.007-.002a54.473 54.473 0 0 1-1.253-.431c-.252-.11-.36-.246-.527-.54-.188-.332-.182-.746-.045-1.116.126-.398.42-.685.847-.892.268-.105.743.026 3.071.73a197.948 197.948 0 0 1 1.955.602l.807.254c.017.005.035-.004.04-.018.005-.018-.004-.036-.024-.042l-6.22-2.065c-.34-.094-.582-.325-.77-.656-.189-.333-.182-.747-.027-1.167.116-.265.273-.461.573-.72.374-.24.823-.333 1.244-.2l7.25 2.428c.017.006.035-.004.04-.017.005-.018-.004-.036-.027-.043l-5.107-1.726c-.373-.137-.663-.398-.766-.676-.178-.313-.183-.662-.073-1.057a1.47 1.47 0 0 1 .473-.651c.408-.34.942-.459 1.371-.27l7.475 2.68c.035.01.047.007.035.023z" />
            </g>
          </svg>
          <span className={cn(`${plugin}-count`)}>{count > 0 && count}</span>
        </button>
      </div>
    );
  }
}

export default withReaction('respect')(RespectButton);
